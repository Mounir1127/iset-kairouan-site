;/*FB_PKG_DELIM*/

__d("CheckQueue",[],(function(t,n,r,o,a,i){var e,t=(e=window)!=null?e:self,l=t.setInterval,s=t.clearInterval,u=3e3,c=2,d=1e4,m=(function(){function e(e,t){var n,r,o;t===void 0&&(t={}),this.$1=[],this.$2=e,this.$4=(n=t.checkInterval)!=null?n:u,this.$5=(r=t.checkIntervalChangeFactor)!=null?r:c,this.$6=(o=t.maxQueueLength)!=null?o:d}var t=e.prototype;return t.start=function(){var e=this;this.$3==null&&(this.$3=l(function(){var t=[],n=Date.now();for(var r of e.$1){if(n<r.lastCheckTimeStamp+r.timeDeltaFromRelease){t.push(r);continue}r.lastCheckTimeStamp=n,e.$2(r)===!1&&(r.timeDeltaFromRelease*=e.$5,t.push(r))}e.$1=t,e.$1.length===0&&(s(e.$3),e.$3=null)},this.$4))},t.enqueue=function(t){this.start(),this.$1.length<this.$6&&this.$1.push(t)},e})();i.CheckQueue=m}),66);
__d("LiveObjectMonitorTableClass",["ExecutionEnvironment","FBLogger","WeakRefApiUtils","clearInterval","performance","setInterval","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e=["state"],s,u,c,d=(s=window)!=null?s:self,m=o("WeakRefApiUtils").getNativeWeakMapOrFallback(),p=o("WeakRefApiUtils").getNativeWeakRefOrFallback(),_=o("WeakRefApiUtils").isWeakAPINative();_||r("FBLogger")("comet_performance.memory").warn("Browser doesn't support weak reference API");var f=(function(){function t(){this.$4=2e4,this.isStarted=!1,this.shouldReport=!0,this.$1=new m,this.$2=new Set,this.$5=[],this.$3=this.$6()}var n=t.prototype;return n.setScanIntervalMs=function(t){this.$4=t},n.getScanIntervalMs=function(){return this.$4},n.getSize=function(){return this.$2.size},n.getAllRefs=function(){return Array.from(this.$2)},n.$8=function(t){this.$2.forEach(function(e){t(e)})},n.$9=function(t){var e=null;return this.$8(function(n){var r=n.deref();r===t&&(e=n)}),e},n.initStateData_DO_NOT_USE=function(t){var e=this.$10(),n=t.deref(),r=0;try{r=JSON.stringify(n||{}).length}catch(e){}return{ref:t,approxSize:r,lastScaned:e}},n.$11=function(){return new Error("no error").stack},n.$6=function(){if((u||(u=r("ExecutionEnvironment"))).canUseDOM&&d.FinalizationRegistry!=null)return new d.FinalizationRegistry(t.$7)},n.$10=function(){return(u||(u=r("ExecutionEnvironment"))).canUseDOM||(c||(c=r("performance"))).now!=null?(c||(c=r("performance"))).now():(r("FBLogger")("comet_performance.memory").warn("Need to be able to call performance.now()"),0)},n.getMonitorMetaData=function(t){var e=t.deref();return e==null?void 0:this.$1.get(e)},n.setMonitorMetaData=function(t,n){var e=t.deref();e!=null&&this.$1.set(e,n)},n.deleteMonitorMetaData=function(t){var e=t.deref();e!=null&&this.$1.delete(e)},n.updateRefData_DO_NOT_USE=function(n){var t=this.initStateData_DO_NOT_USE(n),r=this.getMonitorMetaData(n);if(r&&t){var o=r.state,a=babelHelpers.objectWithoutPropertiesLoose(r,e);this.setMonitorMetaData(n,babelHelpers.extends({},a,{state:t}))}},n.fullScan_DO_NOT_USE=function(){var e=this;this.$8(function(t){e.updateRefData_DO_NOT_USE(t)}),this.afterPeoridicChecking_DO_NOT_USE()},n.afterPeoridicChecking_DO_NOT_USE=function(){},n.getRefSet=function(){return this.$2},n.$12=function(){(u||(u=r("ExecutionEnvironment"))).canUseDOM&&d.gc!=null&&d.gc()},n.start=function(){var e=this;if(!_)return!1;this.isStarted=!0;var t=r("setInterval")(function(){e.$12(),e.fullScan_DO_NOT_USE(),e.shouldReport&&e.report()},this.$4);return this.$5=[t],!0},n.stop=function(){this.$5.map(function(e){return r("clearInterval")(e)}),this.$5=[],this.$1=new m,this.$2=new Set,this.isStarted=!1,this.$3=this.$6()},n.add=function(t){if(!_)return t;if(this.isStarted||this.start(),t==null)throw r("FBLogger")("comet_performance.memory").info("You passed a null into LiveObjectMonitorTable.add()");if(typeof t!="object")throw r("FBLogger")("comet_performance.memory").info("Can only pass objects for now");var e=new p(t),n={id:""+r("uuidv4")(),stack:this.$11(),creationTime:this.$10(),state:this.initStateData_DO_NOT_USE(e)};return this.trackObject_DO_NOT_USE(t,e,n),t},n.trackObject_DO_NOT_USE=function(t,n,r){var e;this.$2.add(n),this.setMonitorMetaData(n,r),(e=this.$3)==null||e.register(t,{set:this.$2,ref:n},n)},n.inspectObj=function(t){if(t==null)throw r("FBLogger")("comet_performance.memory").info("You passed a null into LiveObjectMonitorTable.inspectObj()");if(typeof t!="object")throw r("FBLogger")("comet_performance.memory").info("Can only pass objects for now");var e=this.$9(t);if(e)return this.updateRefData_DO_NOT_USE(e),this.getMonitorMetaData(e)},n.inspectRef=function(t){return this.updateRefData_DO_NOT_USE(t),this.getMonitorMetaData(t)},n.removeDataForWeakRef=function(t){this.deleteMonitorMetaData(t),this.$2.delete(t)},n.refByID=function(t){var e=this,n;return this.$8(function(r){var o=e.getMonitorMetaData(r);o&&o.id===t&&(n=r)}),n},n.report=function(){var e=this;if(!this.shouldReport)return[];var t=this.$10(),n=[];return this.$8(function(r){var o=e.inspectRef(r);o&&n.push({id:o.id,age:t-o.creationTime,size:o.state.approxSize,stackTrace:o.stack})}),n.length>0&&n.sort(function(e,t){return t.age-e.age}),n},n.stackForRef=function(t){var e=this.getMonitorMetaData(t);if(e!=null){var n=e==null?void 0:e.stack;if(n!=null)return n}return null},t})();f.$7=function(e){var t=e.set,n=e.ref;t.delete(n)},l.default=f}),98);
__d("MemMinderConfig",["justknobx"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){var e;this.gcInterval=(e=r("justknobx"))._("1525"),this.dataLogAgeLowerBound=e._("670")*6e4,this.dataLogAgeUpperBound=e._("781")*6e4,this.logDecayFactor=e._("1575")/100,this.releasedObjectCheckInterval=e._("1822"),this.objectScanInterval=e._("1823"),this.objectScanQueueMaxLength=e._("1824"),this.objectReleaseCheckInterval=e._("1825"),this.objectReleaseCheckQueueMaxLength=e._("1826"),this.objectReleaseCheckIntervalChangeFactor=e._("905")/100,this.$1=!1}var t=e.prototype;return t.debugLogOn=function(){this.$1=!0},t.debugLogOff=function(){this.$1=!1},t.debugLogIsOn=function(){return this.$1},e})(),s=new e;l.default=s}),98);
__d("MemMinderUtils",["MemMinderConfig"],(function(t,n,r,o,a,i,l){var e=console,s=(function(){function t(){}var n=t.prototype;return n.debugConsoleLog=function(){r("MemMinderConfig").debugLogIsOn()&&e.log.apply(e,arguments)},n.decayProbability=function(t,n){return n===void 0&&(n=r("MemMinderConfig").logDecayFactor),Math.exp(-n*t)},t})(),u=new s;l.default=u}),98);
__d("MemMinderLogger",["CurrentUser","MemMinderConfig","MemMinderUtils","Random","gkx","requireDeferred"],(function(t,n,r,o,a,i,l){var e=r("requireDeferred")("LogWebMemoryProxyMetricsFalcoEvent").__setRef("MemMinderLogger"),s=r("gkx")("21033"),u=r("CurrentUser").getAppID(),c=(function(){function t(){this.$1=new Map}var n=t.prototype;return n.$2=function(t){var e;if(!s||t.ageSinceRelease<r("MemMinderConfig").dataLogAgeLowerBound||t.ageSinceRelease>r("MemMinderConfig").dataLogAgeUpperBound)return!1;var n=t.useCaseId,o=Math.floor(t.ageSinceRelease/(60*1e3)),a=n+":"+o,i=(e=this.$1.get(a))!=null?e:0;return r("Random").random()>r("MemMinderUtils").decayProbability(i)?!1:(this.$1.set(a,++i),!0)},n.log=function(n){this.$2(n)&&e.onReady(function(e){e.log(function(){var e={app_id:u,use_case_id:n.useCaseId,objects_retained:String(n.numberOfObjectsRetained),age_since_release:String(n.ageSinceRelease)};return r("MemMinderUtils").debugConsoleLog("Logging to Falco: ",e),e})})},t})(),d=new c;l.default=d}),98);
__d("MemMinderClass",["CheckQueue","FBLogger","LiveObjectMonitorTableClass","MemMinderConfig","MemMinderLogger","MemMinderUtils","WeakRefApiUtils"],(function(f,n,r,o,a,i,l){"use strict";var e,t,s=(t=o("WeakRefApiUtils")).isWeakAPINative(),u=r("FBLogger")("MemMinder"),c=0,d=100,m=t.getNativeWeakRefOrFallback(),p=t.getNativeWeakSetOrFallback(),_=t.getNativeWeakMapOrFallback(),f=(e=window)!=null?e:self,g=f.setTimeout,h=f.setInterval,y={},C=void 0,b={},v=function(){return!1},S=function(){return 0},R={isOversize:v,proxySize:S},L=(function(e){function t(){var t;return t=e.call(this)||this,t.$MemMinderClass$p_1=new Map,t.$MemMinderClass$p_2=new p,t.$MemMinderClass$p_3=new _,t.$MemMinderClass$p_4=new(o("CheckQueue")).CheckQueue(function(e){switch(e.type){case"SINGLE":return t.$MemMinderClass$p_5(e.id,e);case"SET":return t.$MemMinderClass$p_6(e.idSet,e);default:return!0}},{checkInterval:r("MemMinderConfig").objectReleaseCheckInterval,checkIntervalChangeFactor:r("MemMinderConfig").objectReleaseCheckIntervalChangeFactor,maxQueueLength:r("MemMinderConfig").objectReleaseCheckQueueMaxLength}),t.setScanIntervalMs(r("MemMinderConfig").objectScanInterval),t.shouldReport=!1,t}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.$MemMinderClass$p_7=function(t){return b[t]},n.start=function(){var t=this;if(this.isStarted)return!0;var n=e.prototype.start.call(this);return n===!1?!1:(h(function(){t.$MemMinderClass$p_8()},r("MemMinderConfig").gcInterval),!0)},n.$MemMinderClass$p_8=function(){var e=this.$MemMinderClass$p_1;for(var t of e.entries()){var n=t[0],r=t[1];r.deref()===void 0&&e.delete(n)}},n.track=function(t,n,o){var e;if(o===void 0&&(o=R),!s||n==null||typeof n!="object"&&typeof n!="function"||this.getSize()>=r("MemMinderConfig").objectScanQueueMaxLength)return C;if(this.$MemMinderClass$p_2.has(n))return this.$MemMinderClass$p_3.get(n);this.isStarted||this.start(),this.$MemMinderClass$p_7(t);var a=babelHelpers.extends({isOversize:v,proxySize:S},o),i=new m(n),l={useCaseId:t,nextScanTimeStamp:Date.now()+((e=a.monitorIntervalMs)!=null?e:r("MemMinderConfig").objectScanInterval),userData:a},u=this.$MemMinderClass$p_9(i,a);if(u==null)return C;var d=""+c++,p={id:""+d,stack:"",creationTime:Date.now(),state:u,additionalMetaData:l};return this.trackObject_DO_NOT_USE(n,i,p),this.$MemMinderClass$p_2.add(n),this.$MemMinderClass$p_3.set(n,d),this.$MemMinderClass$p_1.set(d,i),d},n.monitor=function(t,n,r){return r===void 0&&(r=R),this.track(t,n,r),n},n.expectObjectsToRelease=function(t){if(t.size!==0){var e=Date.now();for(var n of t){var o=n[0],a=n[1];a.size!==0&&(r("MemMinderUtils").debugConsoleLog("["+(o!=null?o:"")+"] expecting "+a.size+" objects to release"),this.$MemMinderClass$p_4.enqueue({useCaseId:o,idSet:a,type:"SET",releaseTimeStamp:e,lastCheckTimeStamp:e,timeDeltaFromRelease:r("MemMinderConfig").releasedObjectCheckInterval}))}}},n.expectObjectToRelease=function(t,n){r("MemMinderUtils").debugConsoleLog("["+(t!=null?t:"")+"] expecting object with id "+n+" to release");var e=Date.now();this.$MemMinderClass$p_4.enqueue({type:"SINGLE",useCaseId:t,id:n,releaseTimeStamp:e,lastCheckTimeStamp:e,timeDeltaFromRelease:r("MemMinderConfig").releasedObjectCheckInterval})},n.$MemMinderClass$p_10=function(t){var e=Date.now()-t.releaseTimeStamp;return e>r("MemMinderConfig").dataLogAgeUpperBound},n.$MemMinderClass$p_5=function(t,n){if(r("MemMinderUtils").debugConsoleLog("check object with id "+t+" release"),!this.$MemMinderClass$p_1.has(t))return!0;var e=this.$MemMinderClass$p_1.get(t);return e==null?(this.$MemMinderClass$p_1.delete(t),!0):this.$MemMinderClass$p_10(n)||e.deref()==null?(this.removeDataForWeakRef(e),!0):(r("MemMinderUtils").debugConsoleLog("object with id "+t+" is still retained"),!1)},n.$MemMinderClass$p_6=function(t,n){if(t.size===0)return!0;var e=n.useCaseId;r("MemMinderUtils").debugConsoleLog("["+e+"] expecting "+t.size+" objects to release");var o=t.size;for(var a of Array.from(t))this.$MemMinderClass$p_5(a,n)===!0&&t.delete(a);return r("MemMinderLogger").log({useCaseId:e,numberOfObjectsRetained:t.size,ageSinceRelease:Date.now()-n.releaseTimeStamp}),t.size>0?r("MemMinderUtils").debugConsoleLog("["+e+"] "+t.size+" objects are still retained"):r("MemMinderUtils").debugConsoleLog("["+e+"] "+o+" successfully released"),t.size===0},n.removeDataForWeakRef=function(n){var t,r=(t=this.getMonitorMetaData(n))==null?void 0:t.id;r!=null&&this.$MemMinderClass$p_1.delete(r);var o=n.deref();o!=null&&(this.$MemMinderClass$p_3.delete(o),this.$MemMinderClass$p_2.delete(o)),e.prototype.removeDataForWeakRef.call(this,n)},n.updateRefData_DO_NOT_USE=function(t){var e;if(t.deref()==null){this.removeDataForWeakRef(t);return}var n=this.getMonitorMetaData(t);if(n==null){this.removeDataForWeakRef(t);return}var o=n.additionalMetaData;if(o==null){this.removeDataForWeakRef(t);return}if(!(o.nextScanTimeStamp>Date.now())){var a=this.$MemMinderClass$p_11(t,o.userData);if(a==null){this.removeDataForWeakRef(t);return}n.state.approxSize=a.approxSize,n.state.lastScaned=a.lastScaned,o.nextScanTimeStamp=Date.now()+((e=o.userData.monitorIntervalMs)!=null?e:r("MemMinderConfig").objectScanInterval)}},n.afterPeoridicChecking_DO_NOT_USE=function(){var e=this.getRefSet().size;r("MemMinderUtils").debugConsoleLog("number of objects being monitored: %s",e)},n.$MemMinderClass$p_9=function(t,n){var e=this.$MemMinderClass$p_11(t,n);return e==null?null:babelHelpers.extends({ref:t},e)},n.$MemMinderClass$p_11=function(t,n){var e=t.deref();if(e==null)return null;var r=Date.now();if(n.proxySize===S&&n.isOversize===v)return{approxSize:0,lastScaned:r};var o=this.guardCall(function(){return n.proxySize(e)},t);return typeof o!="number"?null:{approxSize:o,lastScaned:r}},n.guardCall=function(t,n){var e=0,r=0,o;try{e=Date.now(),o=t(),r=Date.now()}catch(e){return u.warn("callback fail to execute"),this.removeDataForWeakRef(n),y}return r-e>d&&u.warn("Invoking the callback took "+(r-e)+"ms,"+("which is longer than "+d+"ms.")+" Please optimize your callback function."),o},t})(r("LiveObjectMonitorTableClass"));l.default=L}),98);
__d("MemMinder",["MemMinderClass","WeakRefApiUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WeakRefApiUtils").isWeakAPINative()?new(r("MemMinderClass")):null,s=e;l.default=s}),98);
__d("useMemMinder",["MemMinder","react"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useEffect,d=s.useLayoutEffect,m=s.useMemo,p=s.useRef,_=s.useState;function f(e,t){var n=p(null);n.current==null&&(n.current=new Map);var o=r("MemMinder")==null?void 0:r("MemMinder").track(e,t);if(o!=null){var a,i;if(((a=n.current)==null?void 0:a.has(e))===!1){var l;(l=n.current)==null||l.set(e,new Set([o]))}(i=n.current)==null||(i=i.get(e))==null||i.add(o)}return c(function(){return function(){if(n.current!=null){var e;r("MemMinder")==null||r("MemMinder").expectObjectsToRelease(n.current),(e=n.current)==null||e.clear(),n.current=null}}},[]),t}function g(e,t){var n=p(null),o=r("MemMinder")==null?void 0:r("MemMinder").track(e,t);return o!=null&&(n.current=new h(e,o)),c(function(){return function(){if(n.current!=null){var e=n.current;r("MemMinder")==null||r("MemMinder").expectObjectToRelease(e.useCaseId,e.objectId),n.current=null}}}),t}var h=function(t,n){this.useCaseId=t,this.objectId=n};function y(e){var t=p(null);if(t.current==null&&r("MemMinder")){var n,o=new h(e,"");o.objectId=(n=r("MemMinder").track(e,o))!=null?n:"",t.current=o}c(function(){return function(){t.current!=null&&(r("MemMinder")==null||r("MemMinder").expectObjectToRelease(t.current.useCaseId,t.current.objectId),t.current=null)}},[])}function C(e,t){var n=t===void 0?"USE_STATE":t,r=_(e),o=r[0],a=r[1],i=typeof o=="object"?o:null;return f(n,i),f(n,a),r}function b(e,t,n){var r=n===void 0?"USE_EFFECT":n;f(r,e),f(r,t),c(e,t)}function v(e,t,n){var r=n===void 0?"USE_LAYOUT_EFFECT":n;f(r,e),f(r,t),d(e,t)}function S(e,t,n){return n===void 0&&(n="USE_CALLBACK"),f(n,e),f(n,t),u(e,t)}function R(e,t,n){n===void 0&&(n="USE_MEMO"),f(n,e),f(n,t);var r=m(e,t);return f(n,typeof r=="object"?r:null),r}l.useMemMinder=f,l.useTrackReactElement=g,l.useComponentReleaseCheckAfterUnmount=y,l.useState=C,l.useEffect=b,l.useLayoutEffect=v,l.useCallback=S,l.useMemo=R}),98);